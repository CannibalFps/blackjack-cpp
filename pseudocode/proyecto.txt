Inicio
Estructura Carta:
    - palo: string
    - valor: string
    - puntaje: entero

Función barajarMazo():
    Crear un vector vacío de Carta llamado mazo
    Definir palos como ["Corazones", "Diamantes", "Tréboles", "Picas"]
    Definir valores como ["2", "3", ..., "10", "J", "Q", "K", "A"]
    Definir puntajes como [2, 3, ..., 10, 10, 10, 10, 11]

    Para cada palo en palos:
        Para i desde 0 hasta 12:
            Crear carta con palo, valor y puntaje correspondiente
            Añadir carta al mazo

    Barajar mazo aleatoriamente
    Retornar mazo

Función repartirCarta(mazo):
    Si mazo está vacío:
        mazo ← barajarMazo()
    carta ← último elemento de mazo
    Remover último elemento de mazo
    Retornar carta

Función calcularPuntaje(mano):
    puntaje ← 0
    ases ← 0

    Para cada carta en mano:
        puntaje ← puntaje + carta.puntaje
        Si carta.valor es "A":
            ases ← ases + 1

    Mientras puntaje <= 11 y ases > 0:
        puntaje ← puntaje + 10
        ases ← ases - 1

    Retornar puntaje

Función manejarAs():
    Imprimir "Has sacado un As. ¿Deseas que valga 1 o 11?"
    Leer respuesta
    Mientras respuesta no sea 1 o 11:
        Leer respuesta
    Retornar respuesta

Función registrarPartida(resultado, puntajeJugador, puntajeComputadora, apuesta):
    Abrir archivo "historial.txt" en modo de escritura
    Escribir resultado, puntajeJugador, puntajeComputadora, apuesta en el archivo
    Cerrar archivo

Función verHistorial():
    Abrir archivo "historial.txt" en modo de lectura
    Mientras haya líneas en el archivo:
        Leer línea
        Imprimir línea
    Cerrar archivo

Función iniciarJuego():
    dineroJugador ← 1000
    mazo ← barajarMazo()
    seguirJugando ← verdadero

    Mientras seguirJugando y dineroJugador > 0:
        Imprimir "Tienes dineroJugador monedas. ¿Cuánto deseas apostar?"
        Leer apuesta

        Si apuesta > dineroJugador:
            Imprimir "No tienes suficiente dinero."
            Continuar

        dineroJugador ← dineroJugador - apuesta

        manoJugador ← []
        manoComputadora ← []

        manoJugador.Añadir repartirCarta(mazo)
        manoJugador.Añadir repartirCarta(mazo)
        manoComputadora.Añadir repartirCarta(mazo)
        manoComputadora.Añadir repartirCarta(mazo)

        Si calcularPuntaje(manoJugador) == 21:
            Imprimir "¡BLACKJACK! Has ganado."
            dineroJugador ← dineroJugador + apuesta * 1.5
            registrarPartida("Victoria (BLACKJACK)", calcularPuntaje(manoJugador), calcularPuntaje(manoComputadora), apuesta)
            Continuar

        Si calcularPuntaje(manoComputadora) == 21:
            Imprimir "¡BLACKJACK! La computadora ha ganado."
            registrarPartida("Derrota (BLACKJACK)", calcularPuntaje(manoJugador), calcularPuntaje(manoComputadora), apuesta)
            Continuar

        Imprimir cartas de manoJugador y puntaje
        Imprimir carta visible de manoComputadora

        plantarse ← falso
        Mientras no plantarse y calcularPuntaje(manoJugador) < 21:
            Imprimir "¿Deseas pedir otra carta (hit) o plantarte (stand)?"
            Leer acción

            Si acción es "hit":
                nuevaCarta ← repartirCarta(mazo)
                Imprimir "Has sacado: ", nuevaCarta
                manoJugador.Añadir nuevaCarta
                Si nuevaCarta.valor es "A":
                    nuevaCarta.puntaje ← manejarAs()
                Imprimir puntaje actual

                Si calcularPuntaje(manoJugador) > 21:
                    Imprimir "¡Te has pasado de 21! Has perdido."
                    registrarPartida("Derrota", calcularPuntaje(manoJugador), calcularPuntaje(manoComputadora), apuesta)
                    Salir del ciclo

            Sino si acción es "stand":
                plantarse ← verdadero

        Si calcularPuntaje(manoJugador) <= 21:
            Mientras calcularPuntaje(manoComputadora) < 17:
                nuevaCarta ← repartirCarta(mazo)
                manoComputadora.Añadir nuevaCarta
                Imprimir carta sacada por la computadora

            Imprimir cartas de manoComputadora y puntaje

            Si calcularPuntaje(manoJugador) > calcularPuntaje(manoComputadora):
                Imprimir "¡Has ganado!"
                dineroJugador ← dineroJugador + apuesta * 2
                registrarPartida("Victoria", calcularPuntaje(manoJugador), calcularPuntaje(manoComputadora), apuesta)
            Sino si calcularPuntaje(manoJugador) < calcularPuntaje(manoComputadora) y calcularPuntaje(manoComputadora) <= 21:
                Imprimir "La computadora ha ganado."
                registrarPartida("Derrota", calcularPuntaje(manoJugador), calcularPuntaje(manoComputadora), apuesta)
            Sino:
                Imprimir "¡Empate!"
                dineroJugador ← dineroJugador + apuesta

        Imprimir "¿Deseas jugar otra ronda? (sí/no)"
        Leer respuesta
        seguirJugando ← (respuesta == "sí")

        Si dineroJugador <= 0:
            Imprimir "Te has quedado sin dinero, fin del juego."
            Salir

Fin del juego

Función menuPrincipal():
    Imprimir "Bienvenido al Blackjack. Selecciona una opción:"
    Imprimir "1. Iniciar nuevo juego."
    Imprimir "2. Ver historial de juegos."
    Imprimir "3. Salir."
    Leer opción

    Mientras opción no sea 3:
        Si opción = 1:
            iniciarJuego()
        Sino si opción = 2:
            verHistorial()
        Otras opciones:
            Imprimir "Opción no válida."
        
        Llamar a menuPrincipal()
    
    Imprimir "Gracias por jugar."
Fin